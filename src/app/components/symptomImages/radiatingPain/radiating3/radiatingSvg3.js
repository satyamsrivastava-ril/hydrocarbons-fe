import React from "react";

import "../radiatingPainSvg.scss";

import PropTypes from "prop-types";

/**

 * Component for the abdomen svg

 *

 * @component

 * @example

 * const setShowAbdomen = () => {}

 * return (

 *  <AbdomenSvg setShowAbdomen={setShowAbdomen} />

 * )

 */

const RadiatingSvg3 = () => {
  var dt = 0.003,// step size
  vision = 10;
    
  const dot = {
    sprite: [],

    track: [],	// how many steps to look ahead for rotation

    box: [],

    // Initialize the dot: connect sprite and track properties with supplied SVG elements

    init: function (sprite, track, ind) {
      console.log(this.sprite, this.track, sprite, track);

      this.sprite[ind] = document.getElementById(sprite);

      this.track[ind] = document.getElementById(track);

      this.box = this.sprite[ind].getBBox();
      console.log(this.sprite, this.track);
    },

    // Put the dot on its spot

    move: function (u, ind) {

      var D = this.track[ind].getTotalLength();
      var p = this.track[ind].getPointAtLength(u * D);

      var X = +(this.box.x + (this.box.width / 2)).toFixed(1),
      Y = +(this.box.y + (this.box.height / 2)).toFixed(1);
      var tX = p.x - X,
      tY = p.y - Y;

      // To calculate angle get one point ahead, and one you just passed
      var p0 = this.track[ind].getPointAtLength(((1+u - 0.5 * vision * dt) % 1) * D);
      var p1 = this.track[ind].getPointAtLength(((u + vision * dt) % 1) * D);

      var angle = Math.atan2 ( p1.y - p0.y, p1.x - p0.x ) * (180 / Math.PI)-90;

      this.sprite[ind].setAttribute("transform",
        "translate("+tX+","+(tY)+") rotate("+angle+","+X+","+Y+")"
      );
    },
  };

  const anim = {
    start: function (duration, ind) {
      this.duration = duration;

      this.tZero = Date.now();

      requestAnimationFrame(() => this.run(ind));
    },

    run: function (ind) {
      let x = Date.now();

      let u = Math.min((x - this.tZero) / (this.duration*2), 1);

      if (u < 0.9) {
        // Keep requesting frames, till animation is ready

        requestAnimationFrame(() => this.run(ind));
      } else {
        this.onFinish(ind);
      }

      dot.move(u, ind);
    },

    onFinish: function (ind) {
      // Schedule the animation to restart
      setTimeout(() => this.start(this.duration, ind), 20);
    },
  };

  React.useEffect(() => {
    dot.init("Arrowhead-3", "Path-333", 0);

    anim.start(1500, 0);
  }, []);

  // window.onload = () => {
  //   dot.init("Oval-2-Copy", "Path-33", 0);

  //   anim.start(2000, 0);

  //   //dot.init('Oval-2', 'Path-29');

  //   //dot.init('Oval-2-Copy','Path-30')

  //   //dot.init('Oval-2-Copy-2','Path-31')

  //   //anim.start(2000);
  // };

  return (
    <div
      style={{
        width: "41%",

        position: "absolute",
      }}
    >
      <svg
        viewBox="0 0 342 787"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g
          xmlns="http://www.w3.org/2000/svg"
          id="Group"
          transform="translate(2.000000, 2.000000)"
          stroke="#20C8B4"
          strokeWidth="2.3"
          strokeOpacity="1"
          fill="none"
          fillOpacity="0"
          strokeLinecap="round"
          strokeLinejoin="round"
        >
          <path
            d="M126.529214,106.668472 C127.589451,107.497778 129.028622,108.052733 130.846725,108.333339 C132.664829,108.613944 137.647972,109.050205 145.796154,109.642123 C149.525625,122.559554 151.575135,131.049824 151.944684,135.112933 C152.499008,141.207597 110.423321,167.108516 97.0899163,200.512727 C95.6177226,204.201018 94.8550546,208.716294 94.8853754,213.621503 C94.9027569,216.433425 95.6376039,221.11409 97.0899163,227.663498 C98.0479864,264.385601 99.6808022,294.168696 101.988364,317.012784 C104.295926,339.856871 107.183088,354.820048 110.649852,361.902316 L110.649852,378.773694"
            id="Path-21"
            stroke="#20C8B4"
            stroke-width="4"
            stroke-linecap="round"
          ></path>

          <path
            d="M116.3797,431.499443 C118.40765,449.167742 120.439117,465.408455 121.982005,476.877961 C124.894914,498.531924 127.088692,510.21889 128.56334,511.93886 C134.579254,525.216057 138.583214,535.470323 140.575221,542.701656 C143.563231,553.548656 143.787316,566.951347 146.753888,573.910767 C149.720459,580.870186 156.794426,583.114562 159.984937,592.559061 C161.638904,597.455108 166.480173,628.24111 169.328288,684.28127 C170.142858,700.308928 172.61059,730.403404 169.328288,738.321558 C166.045987,746.239711 130.655593,766.805513 125.052856,768.859237 C119.45012,770.912961 111.389016,768.088645 104.898955,770.795028 C100.572248,772.599283 97.969235,776.053521 97.0899163,781.157741 L206.03067,781.157741 C209.976128,777.368535 211.494276,773.269033 210.585113,768.859237 C209.221368,762.244542 200.069473,752.245032 197.774468,740.215339 C195.479462,728.185646 216.860972,645.677683 218.704347,615.679537 C220.547721,585.681391 195.736974,561.417508 193.285467,555.162037 C190.833959,548.906566 187.768206,544.290354 187.768206,536.740292 C187.768206,531.706917 190.327358,495.31559 195.445662,427.566312 C207.819718,402.90771 213.338826,384.236834 212.002985,371.553684 C210.667144,358.870534 201.060534,338.732594 183.183155,311.139866 C182.837436,298.205618 183.517282,288.417119 185.222692,281.774372 C186.944323,275.068446 205.406972,230.377261 212.002985,193.074545 C215.207778,174.950336 212.461276,158.161076 209.674828,149.105311 C201.153391,121.411234 193.285467,129.638566 193.285467,107.774295 C193.285467,101.12917 195.18103,94.7295774 197.774468,87.584971 C200.869774,79.0577757 209.674828,68.6345457 212.002985,58.120694 C214.331142,47.6068422 214.274629,18.3382931 182.003821,7.29159552 C149.733013,-3.75510203 130.308318,23.9766063 128.56334,28.8378672 C126.818363,33.699128 124.78337,41.4105951 124.248421,45.8728912 C123.891788,48.8477553 124.159933,52.9303562 125.052856,58.120694 C117.741349,70.9945895 115.173304,77.697742 117.348721,78.2301517 C119.524138,78.7625614 121.824038,79.6103639 124.248421,80.7735593 C124.248421,95.9467188 124.966971,104.524753 126.404072,106.507661"
            id="Path-21-Copy"
            stroke="#20C8B4"
            stroke-width="4"
            stroke-linecap="round"
          ></path>

          <path
            d="M139.848909,207.587643 C141.379546,206.866278 142.438758,206.590766 143.026545,206.761106 C143.908225,207.016617 144.673755,207.569538 145.061553,209.044845 C145.449351,210.520152 143.490865,219.222498 142.516161,223.925632 C140.51651,233.574338 138.399798,241.84849 138.222186,247.297074 C137.825906,259.453711 141.985274,279.724165 141.47489,286.709287 C141.257043,289.690745 134.026462,297.379749 127.894692,320.178797 C124.449233,332.989649 120.919561,370.30686 118.813239,373.198259 C116.706917,376.089658 103.197971,387.50027 99.5842239,393.5 C98.2578866,395.702054 96.5597437,401.000177 94.2631395,406.482724 C92.8881809,409.765081 90.7475004,413.229203 89.8795323,415.812345 C88.2472109,420.670263 90.1965172,421.202507 91.4903153,421.202507 C92.7841135,421.202507 94.6984044,417.900005 99.5842239,410.47665 C101.274521,407.908468 104.630016,401.152109 106.260938,402.277967 C106.964926,402.763944 107.985321,410.312003 103.430413,423.900862 C101.791186,428.79124 93.7429873,437.098339 91.0008825,443.468555 C89.5944957,446.735749 91.3667195,449.14036 92.5725363,450.550703 C94.133853,452.376845 98.8762934,446.86407 107.440739,438.408435 C111.883491,434.022128 120.57655,427.251945 123.123499,421.812889 C124.821465,418.186852 128.277941,406.116844 133.492927,385.602867 C145.888403,366.492621 154.276042,351.841797 158.655845,341.650395 C161.341178,335.401872 166.641687,326.897817 169.127722,317.454323 C170.696434,311.495387 169.841962,299.95667 171,298.327334 C172.158038,296.697999 175.086544,294.048051 176.646956,288.870313 C178.207367,283.692575 177.329274,279.402828 178.153283,274.591397 C182.110482,259.200241 190.833044,240.066395 195.052343,224.944312 C197.005097,217.945588 201.243165,204.249041 203.309501,193.965058 C204.089401,190.083558 204.534613,185.419874 204.645137,179.974005"
            id="Path-22"
            stroke="#20C8B4"
            stroke-width="4"
          ></path>

          <path
            d="M145.756077,109.965728 C153.055659,106.581639 157.839483,103.2494 160.107548,99.9690119 C162.375613,96.6886239 163.426704,91.5816076 163.26082,84.647963"
            id="Path-23"
            stroke="#20C8B4"
            stroke-width="3"
            stroke-linecap="round"
          ></path>

          <path
            d="M158.092852,588.08427 C160.9993,584.566792 162.717872,581.815506 163.248569,579.830409 C163.779266,577.845312 163.779266,574.168201 163.248569,568.799075"
            id="Path-24"
            stroke="#20C8B4"
            stroke-width="3"
            stroke-linecap="round"
          ></path>

          <path
            d="M147.293447,142.590536 C150.434955,140.47649 153.193561,139.25101 155.569267,138.914096 C157.944972,138.577181 163.827674,138.577181 173.217372,138.914096"
            id="Path-25"
            stroke="#20C8B4"
            stroke-width="3"
            stroke-linecap="round"
          ></path>

          <path
            d="M97.361558,226.369119 C100.515942,227.63709 104.054677,228.271076 107.977764,228.271076 C111.900851,228.271076 114.882952,227.63709 116.924068,226.369119"
            id="Path-26"
            stroke="#20C8B4"
            stroke-width="3"
            stroke-linecap="round"
          ></path>

          <path
            d="M141.661138,287.01168 C144.575553,284.953216 146.409944,283.174487 147.164309,281.675495 C147.918675,280.176502 148.573112,277.009702 149.127623,272.175096"
            id="Path-27"
            stroke="#20C8B4"
            stroke-width="3"
            stroke-linecap="round"
          ></path>

          <path
            d="M195.315913,427.866865 C191.68557,427.126746 188.993089,426.316438 187.23847,425.435941 C185.483851,424.555444 183.757318,423.148217 182.058869,421.21426"
            id="Path-28"
            stroke="#20C8B4"
            stroke-width="3"
            stroke-linecap="round"
          ></path>
        </g>

        <g className="parent" fill="none">
          <path
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            d="M154.652444,125.894226 C172.6587,129.008462 184.074396,138.962428 188.899533,155.756126 C192.000265,166.548104 183.990646,191.242039 171,224.223974 C158.980119,254.741233 160.081234,295.63863 154.652444,311.210855 C145.793055,336.623595 132.389557,369.749567 114.441951,410.588771"
            id="Path-333"
            stroke="#FFBDC9"
            stroke-width="10"
            stroke-miterlimit="10"
            stroke-linecap="round"
          />
          <path
            xmlns="http://www.w3.org/2000/svg"
            id="Path-40-decoration-1"
            d="M114.441951,410.588771 L121.533619,401.908435 L116.040656,399.494442 L114.441951,410.588771 Z"
            stroke="#FFBDC9"
            stroke-width="10"
            stroke-linecap="round"
          />
          <g className="dotted">
            <path
              xmlns="http://www.w3.org/2000/svg"
              d="M154.652444,125.894226 C172.6587,129.008462 184.074396,138.962428 188.899533,155.756126 C192.000265,166.548104 183.990646,191.242039 171,224.223974 C158.980119,254.741233 160.081234,295.63863 154.652444,311.210855 C145.793055,336.623595 132.389557,369.749567 114.441951,410.588771"
              id="Path-40-Copy"
              stroke="#FF7089"
              stroke-width="5"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-dasharray="1,10"
            />
          </g>
        </g>
        <path xmlns="http://www.w3.org/2000/svg" d="M155.4953,116.63197 L170.103472,116.63197 C170.655757,116.63197 171.103472,117.079686 171.103472,117.63197 C171.103472,117.744001 171.084647,117.855234 171.047783,117.961026 L163.743697,138.922022 C163.561965,139.443551 162.991859,139.71901 162.470331,139.537278 C162.182095,139.436839 161.955515,139.210258 161.855076,138.922022 L154.55099,117.961026 C154.369257,117.439497 154.644717,116.869392 155.166245,116.68766 C155.272036,116.650796 155.38327,116.63197 155.4953,116.63197 Z" id="Arrowhead-3" fill="#FF7089" transform="translate(162.799250, 128.112605) scale(-1, 1) rotate(71.000000) translate(-162.799250, -128.112605) " />
      </svg>
    </div>
  );
};

RadiatingSvg3.propTypes = {
  /**

   * Function for showing and hiding abdomen svg component.

   */

  setShowAbdomen: PropTypes.func,
};

export default RadiatingSvg3;
